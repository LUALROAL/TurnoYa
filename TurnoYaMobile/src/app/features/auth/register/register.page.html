<ion-content>
  <div class="t-page t-flex-col t-justify-center" style="min-height: 100vh;">

    <!-- BRAND HEADER (Matches Login) -->
    <header class="auth-header t-flex-col t-items-center t-mb-8">
      <div class="logo-container">
        <ion-icon name="person-add-outline" class="brand-icon"></ion-icon>
      </div>
      <h1 class="t-h1 text-center t-mt-4">Crear Cuenta</h1>
      <p class="t-body text-center t-text-secondary">Únete a TurnoYa</p>
    </header>

    <!-- REGISTER CARD -->
    <main class="t-card auth-card">
      <form [formGroup]="registerForm" (ngSubmit)="onRegister()">

        <!-- Name Fields Row -->
        <div class="t-grid t-grid-cols-2 t-gap-4">
          <div class="t-input-group">
            <label>Nombre</label>
            <div class="input-wrapper">
              <ion-icon name="person-outline"></ion-icon>
              <input type="text" formControlName="firstName" placeholder="Juan" autocomplete="given-name">
            </div>
          </div>
          <div class="t-input-group">
            <label>Apellido</label>
            <div class="input-wrapper">
              <ion-icon name="person-outline"></ion-icon>
              <input type="text" formControlName="lastName" placeholder="Pérez" autocomplete="family-name">
            </div>
          </div>
        </div>

        <!-- Phone -->
        <div class="t-input-group">
          <label>Teléfono</label>
          <div class="input-wrapper">
            <ion-icon name="call-outline"></ion-icon>
            <input type="tel" formControlName="phone" placeholder="123456789" autocomplete="tel">
          </div>
        </div>

        <!-- Email -->
        <div class="t-input-group">
          <label>Email</label>
          <div class="input-wrapper">
            <ion-icon name="mail-outline"></ion-icon>
            <input type="email" formControlName="email" placeholder="tu@email.com" autocomplete="email">
          </div>
        </div>

        <!-- Password -->
        <div class="t-input-group">
          <label>Contraseña</label>
          <div class="input-wrapper">
            <ion-icon name="lock-closed-outline"></ion-icon>
            <input [type]="showPassword ? 'text' : 'password'" formControlName="password" placeholder="••••••••"
              autocomplete="new-password">
            <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'" class="password-toggle"
              (click)="showPassword = !showPassword">
            </ion-icon>
          </div>
          <!-- Password Strength Hint could go here -->
        </div>

        <!-- Confirm Password -->
        <div class="t-input-group">
          <label>Confirmar Contraseña</label>
          <div class="input-wrapper">
            <ion-icon name="lock-closed-outline"></ion-icon>
            <input [type]="showPassword ? 'text' : 'password'" formControlName="confirmPassword" placeholder="••••••••"
              autocomplete="new-password">
          </div>
          @if (registerForm.hasError('passwordMismatch') && confirmPassword?.touched) {
          <p class="error-msg">Las contraseñas no coinciden</p>
          }
        </div>

        <!-- Role Select -->
        <div class="t-input-group">
          <label>Quiero...</label>
          <div class="input-wrapper select-wrapper">
            <ion-icon name="briefcase-outline"></ion-icon>
            <select formControlName="role">
              @for (role of userRoles; track role.value) {
              <option [value]="role.value">{{ role.label }}</option>
              }
            </select>
            <ion-icon name="chevron-down-outline" class="select-arrow"></ion-icon>
          </div>
        </div>

        <!-- Submit Button -->
        <ion-button expand="block" type="submit" [disabled]="registerForm.invalid || isLoading" class="t-mt-6 auth-btn">
          @if (isLoading) {
          <ion-spinner name="crescent"></ion-spinner>
          } @else {
          Registrarse
          }
        </ion-button>

      </form>

      <div class="footer-link t-mt-6 t-text-center">
        <p class="t-caption t-text-secondary">
          ¿Ya tienes cuenta? <a routerLink="/login" class="link-primary">Inicia Sesión</a>
        </p>
      </div>
    </main>
  </div>
</ion-content>
