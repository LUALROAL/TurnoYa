<ion-content class="home-bg" [fullscreen]="true">
  <div class="bg-decoration" aria-hidden="true">
    <div class="bg-orb orb-top"></div>
    <div class="bg-orb orb-bottom"></div>
  </div>

  <div class="home-wrap">
    <header class="home-header glass-panel card">
      <div>
        <p class="home-greeting">Hola de nuevo,</p>
        <h1 class="home-name">TurnoYa</h1>
      </div>

      <ion-button fill="clear" class="notify-btn" aria-label="Notificaciones">
        <ion-icon slot="icon-only" name="notifications-outline"></ion-icon>
      </ion-button>
    </header>

    <section class="home-hero">
      <h2 class="hero-title">¿Que necesitas hoy?</h2>

      <div class="search-shell">
        <ion-icon name="search-outline"></ion-icon>
        <input type="text" placeholder="¿Que servicio buscas?" />
      </div>
    </section>

    <section class="quick-access">
      <h3 class="section-title">Accesos rapidos</h3>

      <div class="quick-grid">
        <button type="button" class="quick-card card" *ngFor="let item of quickAccessItems" [routerLink]="item.route">
          <div class="quick-icon">
            <ion-icon [name]="item.icon"></ion-icon>
          </div>
          <div class="quick-copy">
            <p>{{ item.title }}</p>
            <span>{{ item.subtitle }}</span>
          </div>
        </button>
      </div>
    </section>

    <section class="nearby-availability">
      <div class="section-head">
        <h3 class="section-title">Disponibilidad cercana</h3>
        <button type="button" class="link-btn">Ver mapa →</button>
      </div>

      <div class="map-container card glass-panel">
        <svg class="map-placeholder" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
          <!-- Fondo del mapa -->
          <defs>
            <style>
              .map-street { stroke: rgba(255,255,255,0.1); stroke-width: 1; fill: none; }
              .map-text { font-size: 12px; fill: rgba(255,255,255,0.4); font-family: var(--font-display-a); }
              .map-pin { fill: var(--color-accent-1); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
              .location-icon { font-size: 20px; }
            </style>
          </defs>

          <!-- Grid de calles simuladas -->
          <line class="map-street" x1="0" y1="80" x2="400" y2="80"/>
          <line class="map-street" x1="0" y1="160" x2="400" y2="160"/>
          <line class="map-street" x1="0" y1="240" x2="400" y2="240"/>
          <line class="map-street" x1="80" y1="0" x2="80" y2="300"/>
          <line class="map-street" x1="160" y1="0" x2="160" y2="300"/>
          <line class="map-street" x1="240" y1="0" x2="240" y2="300"/>
          <line class="map-street" x1="320" y1="0" x2="320" y2="300"/>

          <!-- Pines de ubicación -->
          <circle cx="80" cy="80" r="10" class="map-pin"/>
          <circle cx="240" cy="160" r="10" class="map-pin"/>
          <circle cx="320" cy="240" r="8" class="map-pin" opacity="0.7"/>
          <circle cx="120" cy="200" r="9" class="map-pin" opacity="0.8"/>

          <!-- Texto de ubicación aproximada -->
          <text x="20" y="290" class="map-text">Tu ubicación</text>
          <text x="280" y="290" class="map-text">2 min</text>
        </svg>
        <div class="map-overlay">
          <ion-icon name="location-outline" class="location-icon"></ion-icon>
          <p>Click para ver negocios cercanos en el mapa interactivo</p>
        </div>
      </div>
    </section>

    <section class="recommendations">
      <div class="section-head">
        <h3 class="section-title">Recomendados para ti</h3>
        <button type="button" class="link-btn" routerLink="/businesses">Ver todo</button>
      </div>

      <div *ngIf="loadingRecommendations" class="recommendation-list">
        <article class="business-card card skeleton" *ngFor="let item of [1, 2]"></article>
      </div>

      <article *ngIf="!loadingRecommendations && recommendedBusinesses.length === 0" class="empty-state card glass-panel">
        <ion-icon name="sparkles-outline"></ion-icon>
        <p>No encontramos recomendaciones por ahora.</p>
      </article>

      <div *ngIf="!loadingRecommendations && recommendedBusinesses.length > 0" class="recommendation-list">
        <article class="business-card card" *ngFor="let business of recommendedBusinesses; trackBy: trackByBusinessName">
          <div class="business-top">
            <h4>{{ business.name }}</h4>
            <span class="rating-pill">
              <ion-icon name="star"></ion-icon>
              {{ business.rating }}
            </span>
          </div>

          <p class="business-meta">{{ business.category }} · {{ business.distanceKm }} km</p>

          <div class="business-bottom">
            <strong>{{ business.priceLabel }}</strong>
            <ion-button size="small" class="button-primary">Reservar</ion-button>
          </div>
        </article>
      </div>
    </section>
  </div>
</ion-content>
