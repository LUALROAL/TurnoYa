<ion-content class="bg-bg-primary" [fullscreen]="true">
  <!-- Fondo con part√≠culas animadas -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-0 -left-1/4 w-1/2 h-1/2 bg-gradient-radial opacity-30 animate-pulse-slow"></div>
    <div class="absolute bottom-0 -right-1/4 w-1/2 h-1/2 bg-gradient-radial opacity-20 animate-pulse-slow animation-delay-2000"></div>

    <div class="absolute inset-0" style="background-image:
      linear-gradient(rgba(0, 224, 255, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 224, 255, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;">
    </div>
  </div>

  <div class="relative z-10 pb-8">
    <!-- Header mejorado con efecto glass -->
    <header class="sticky top-0 z-20 bg-bg-primary/80 backdrop-blur-xl border-b border-neon-primary/10 px-4 py-3">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-text-secondary font-mono text-xs tracking-wider mb-1">
            <!-- &lt; -->
             HOLA DE NUEVO
            <!-- /&gt; -->
          </p>
          <h1 class="text-2xl font-display font-bold">
            <span class="bg-gradient-to-r from-neon-primary to-neon-secondary bg-clip-text text-transparent">
              {{ getUserName() }}
            </span>
          </h1>
        </div>

        <!-- Bot√≥n de notificaciones con indicador -->
        <div class="relative">
          <button class="relative w-10 h-10 rounded-full bg-bg-tertiary/50 border border-neon-primary/20 flex items-center justify-center hover:border-neon-primary transition-all duration-300">
            <ion-icon name="notifications-outline" class="text-xl text-text-primary"></ion-icon>
            <span class="absolute -top-1 -right-1 w-3 h-3 bg-neon-primary rounded-full animate-ping"></span>
            <span class="absolute -top-1 -right-1 w-3 h-3 bg-neon-primary rounded-full"></span>
          </button>
        </div>
      </div>
    </header>

    <div class="px-4 space-y-8 mt-4">
      <!-- Secci√≥n Hero: ¬øQu√© necesitas hoy? -->
      <section class="space-y-4">
        <h2 class="text-3xl font-display font-bold leading-tight">
          <span class="text-text-primary">¬øQu√©</span>
          <span class="text-neon-primary"> necesitas</span>
          <span class="text-text-primary"> hoy?</span>
        </h2>

        <!-- Buscador futurista -->
        <div class="relative group">
          <div class="absolute -inset-0.5 bg-gradient-glow rounded-2xl opacity-0 group-focus-within:opacity-100 transition-opacity duration-500 blur"></div>
          <div class="relative flex items-center gap-3 px-4 py-4 bg-bg-card/80 backdrop-blur-sm border border-neon-primary/20 rounded-2xl focus-within:border-neon-primary focus-within:shadow-neon transition-all duration-300">
            <ion-icon name="search-outline" class="text-2xl text-neon-primary"></ion-icon>
            <input
              type="text"
              placeholder="Buscar servicios, negocios..."
              class="w-full bg-transparent text-text-primary placeholder-text-tertiary/50 focus:outline-none font-body text-base"
            />
            <kbd class="hidden sm:flex items-center gap-1 px-2 py-1 bg-bg-tertiary rounded-md border border-neon-primary/20 text-xs font-mono text-text-tertiary">
              <span>‚åò</span> K
            </kbd>
          </div>
        </div>
      </section>

      <!-- Accesos R√°pidos -->
      <section class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-display font-semibold text-text-primary flex items-center gap-2">
            <span class="w-1 h-5 bg-neon-primary rounded-full"></span>
            Accesos R√°pidos
          </h3>
          <span class="text-xs font-mono text-neon-primary animate-pulse">‚ö°</span>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
          <ng-container *ngFor="let item of quickAccessItems">
            <button
              *ngIf="item.route !== '/admin/users' || isAdmin()"
              [routerLink]="item.route"
              class="group relative overflow-hidden"
            >
              <div class="absolute -inset-0.5 bg-gradient-glow rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
              <div class="relative p-4 bg-bg-card/60 backdrop-blur-sm border border-neon-primary/10 rounded-xl hover:border-neon-primary/30 transition-all duration-300">
                <div class="flex flex-col items-center text-center gap-2">
                  <div class="w-12 h-12 rounded-full bg-gradient-to-br from-neon-primary/20 to-neon-secondary/20 flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                    <ion-icon [name]="item.icon" class="text-2xl text-neon-primary"></ion-icon>
                  </div>
                  <div>
                    <p class="font-display font-semibold text-text-primary text-sm">{{ item.title }}</p>
                    <span class="text-xs font-mono text-text-tertiary">{{ item.subtitle }}</span>
                  </div>
                </div>
              </div>
            </button>
          </ng-container>
        </div>
      </section>

      <!-- Mapa de Disponibilidad Cercana -->
      <section class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-display font-semibold text-text-primary flex items-center gap-2">
            <span class="w-1 h-5 bg-neon-primary rounded-full"></span>
            Disponibilidad Cercana
          </h3>
          <button class="text-neon-primary hover:text-neon-secondary transition-colors text-sm font-mono flex items-center gap-1">
            Ver mapa <ion-icon name="arrow-forward-outline"></ion-icon>
          </button>
        </div>

        <!-- Mapa interactivo mejorado -->
        <div class="relative group cursor-pointer overflow-hidden rounded-2xl border border-neon-primary/20 hover:border-neon-primary/40 transition-all duration-500">
          <div class="absolute -inset-0.5 bg-gradient-glow rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 blur"></div>

          <div class="relative bg-gradient-card aspect-[16/9] min-h-[200px] p-4">
            <!-- SVG del mapa mejorado -->
            <svg class="w-full h-full opacity-70" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <linearGradient id="glowPin" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#00E0FF;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#00F5D4;stop-opacity:1" />
                </linearGradient>
                <filter id="glow">
                  <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                  <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>

              <!-- Calles con efecto ne√≥n -->
              <line x1="0" y1="80" x2="400" y2="80" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="0" y1="160" x2="400" y2="160" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="0" y1="240" x2="400" y2="240" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="80" y1="0" x2="80" y2="300" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="160" y1="0" x2="160" y2="300" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="240" y1="0" x2="240" y2="300" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>
              <line x1="320" y1="0" x2="320" y2="300" stroke="#00E0FF" stroke-width="0.5" opacity="0.2"/>

              <!-- Pines con efecto 3D -->
              <circle cx="80" cy="80" r="8" fill="url(#glowPin)" filter="url(#glow)">
                <animate attributeName="r" values="8;10;8" dur="2s" repeatCount="indefinite"/>
              </circle>
              <circle cx="240" cy="160" r="8" fill="url(#glowPin)" filter="url(#glow)">
                <animate attributeName="r" values="8;10;8" dur="2s" begin="0.5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="320" cy="240" r="6" fill="url(#glowPin)" filter="url(#glow)">
                <animate attributeName="r" values="6;8;6" dur="2s" begin="1s" repeatCount="indefinite"/>
              </circle>
              <circle cx="120" cy="200" r="7" fill="url(#glowPin)" filter="url(#glow)">
                <animate attributeName="r" values="7;9;7" dur="2s" begin="1.5s" repeatCount="indefinite"/>
              </circle>

              <!-- Texto de ubicaci√≥n -->
              <text x="20" y="290" fill="#9FB3C8" font-family="JetBrains Mono" font-size="10">üìç Tu ubicaci√≥n</text>
              <text x="280" y="290" fill="#00E0FF" font-family="JetBrains Mono" font-size="10">‚ö° 2 min</text>
            </svg>

            <!-- Overlay con informaci√≥n -->
            <div class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-t from-bg-primary/80 via-transparent to-transparent">
              <div class="bg-bg-card/60 backdrop-blur-sm rounded-full px-4 py-2 border border-neon-primary/30 flex items-center gap-2">
                <ion-icon name="location-outline" class="text-neon-primary animate-pulse"></ion-icon>
                <span class="text-text-secondary text-sm font-mono">12 negocios cerca de ti</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recomendaciones -->
      <section class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-display font-semibold text-text-primary flex items-center gap-2">
            <span class="w-1 h-5 bg-neon-primary rounded-full"></span>
            Recomendados para ti
          </h3>
          <button routerLink="/businesses" class="text-neon-primary hover:text-neon-secondary transition-colors text-sm font-mono">
            Ver todo ‚Üí
          </button>
        </div>

        <!-- Skeleton Loader -->
        <div *ngIf="loadingRecommendations" class="space-y-3">
          <div *ngFor="let item of [1, 2, 3]" class="skeleton-card"></div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!loadingRecommendations && recommendedBusinesses.length === 0"
             class="relative group overflow-hidden rounded-2xl border border-neon-primary/10 p-8 text-center">
          <div class="absolute -inset-0.5 bg-gradient-glow rounded-2xl opacity-30"></div>
          <div class="relative">
            <ion-icon name="sparkles-outline" class="text-4xl text-neon-primary mb-3"></ion-icon>
            <p class="text-text-secondary font-mono text-sm">No encontramos recomendaciones por ahora</p>
          </div>
        </div>

        <!-- Lista de Recomendaciones -->
        <div *ngIf="!loadingRecommendations && recommendedBusinesses.length > 0" class="space-y-3">
          <article *ngFor="let business of recommendedBusinesses; trackBy: trackByBusinessName"
                   class="group relative overflow-hidden rounded-2xl">
            <div class="absolute -inset-0.5 bg-gradient-glow rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>

            <div class="relative p-5 bg-bg-card/60 backdrop-blur-sm border border-neon-primary/10 rounded-2xl hover:border-neon-primary/30 transition-all duration-300">
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center gap-3">
                  <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-neon-primary/20 to-neon-secondary/20 flex items-center justify-center">
                    <ion-icon name="business-outline" class="text-2xl text-neon-primary"></ion-icon>
                  </div>
                  <div>
                    <h4 class="font-display font-semibold text-text-primary">{{ business.name }}</h4>
                    <p class="text-xs font-mono text-text-tertiary flex items-center gap-2 mt-1">
                      <span>{{ business.category }}</span>
                      <span class="w-1 h-1 bg-neon-primary rounded-full"></span>
                      <span>{{ business.distanceKm }} km</span>
                    </p>
                  </div>
                </div>

                <!-- Rating -->
                <div class="flex items-center gap-1 px-2 py-1 bg-neon-primary/10 rounded-full border border-neon-primary/20">
                  <ion-icon name="star" class="text-sm text-neon-primary"></ion-icon>
                  <span class="text-xs font-mono text-neon-primary font-bold">{{ business.rating }}</span>
                </div>
              </div>

              <div class="flex items-center justify-between mt-4">
                <span class="text-lg font-display font-bold text-neon-secondary">{{ business.priceLabel }}</span>
                <button class="px-4 py-2 bg-gradient-to-r from-neon-primary to-neon-secondary rounded-full text-bg-primary font-display text-sm font-semibold hover:shadow-neon transition-all duration-300 transform hover:scale-105">
                  Reservar
                </button>
              </div>
            </div>
          </article>
        </div>
      </section>
    </div>
  </div>
</ion-content>
